<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/styles/calculator.css">
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="/styles/styles.css">


</head>
<body>

    <nav>
        <div class="imgBorder">
            <img src="/images/Capture.JPG" alt="">
        </div>
        
        <div class="logo">
            <img src="/images/logo.png">
        </div>

        

        <div class="navLinks">
            <ul>
                <li><a href="./index.html" id="home">HOME</a></li>
                <li><a href="#" id="about">ABOUT</a></li>
                <li><a href="./contact.html" id="contacts">CONTACTS</a></li>
                <li><a href="#" id="calculator">CALCULATOR</a></li>
                <li><a href="#" id="PRICING">PRICING</a></li>
            </ul>
        </div>

        <div class="subscribeDiv">
            <h1> SUBSCRIBE TO PYLANEWS </h1>
            <input placeholder="Enter Email Address"> 
            <p> Subscribe to recieve all kind of updates follow me on 
                <span>github</span><p>
        </div>
    </nav>

    <div class="middleContent">
        <div class="container">
            <div class="settingsBar">
                <img src="../images/settingsIcon.png">
            </div>
            <div class="topBar">
                <div class="dropDownMenu"> 
    
                </div>
    
                <h1> 
                    <span id="titleSpan">PYLA</span> APP
                </h1>
                
                <div class="settings"> 
    
                </div>
    
            </div>
    
            <div class="screen">
                <input>
                <img src="../images/algorithm.png">
            </div>
    
            <div class="graphDiv">
                <div class="graphHistory"></div>
                <div class="graph">
                    <canvas id="myChart" width="100" height="70" style="background-color: transparent;"></canvas>
                </div>
    
               
            <div class="wrapper">
                <div class="barGraph">
                        <canvas id="barGraph" width="100" height="70" style="background-color: transparent;"></canvas>
                    </div>
                </div>
    
                <div class="info">
                    <input style="background-color: transparent ;" type="range" id='red' min="1" max="220" value="164" id="range">
                    <input type="range" id='green' min="7" max="220" value="7" id="range">
                    <input type="range" id='blue' min="7" max="220" value="7" id="range">
                </div>
            </div>
    
    
        </div>
    </div>

    <div class="sideBar">
        <div class="content">
            <h1> COLATZ </h1>
            <h2> PylaAI Colatz Calculator </h2>
            <div class="text"> 
                <div class="littleBorder"></div>
                <p> 
                    PylaAI Colatz Calculator
                    is a simple calculator that
                    can calculate the needed 
                    amount of cycles to reach
                    the number 1 with any given number
                    using the colatz formula 
                    <span>3x+1</span>
                </p> 
            </div>  

            <button> Show me the app </button> 
        </div>
    </div>

    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    
    <script>
    
    let numbers = [1, 1, 1, 10, 20, 60, 50, 30, 100, 20, 50, 3, 70, 10, 20, 60, 50, 30, 100, 201, 10, 20, 60, 50, 30, 100, 20, 50, 3, 70, 10, 20, 60, 50, 30, 105, 100, 201, 1]
    numbers = numbers.slice(3, numbers.length-1)
    const ctx = document.getElementById('myChart');
    const barGraphCanvas = document.getElementById('barGraph')
    let label = [];
    let count = 0;
    for (let num of numbers) {
        label.push(num)
    }
    
    let lineGraph = createChar(ctx, 'line', [1, 2], label, 'rgba(164, 7, 7, 0.858)', 2)
    console.log(lineGraph.data.datasets[0].borderColor, 'data')
    let timeOut = 100;
    let bonus = 100;
    for (let num of numbers) {
        setTimeout(() => { 
            lineGraph.data.datasets[0].data.push(num)
            lineGraph.update()
         }, timeOut);
         timeOut += bonus
        
    }
    const barGraph = createChar(barGraphCanvas, 'bar', groupNumbers(numbers), 
    ['0-100', '100-1k', '1k-10k', '10k-100k', '100k-1m'],'rgba(164, 7, 7, 0.858)', 1)

    function groupNumbers(array) {
        const numbers = [];
        array.sort(function(a, b) {
            return a - b;
        });
        
        let count = 0;
        let groupThreshold = 100;
        for (let num of array) {
            console.log(num)
            if (num < groupThreshold) {
                count += 1;
            } else {
                numbers.push(count);
                count = 0;
                groupThreshold = groupThreshold * 10;
                console.log(`new GROUP THRESHOLD - ${groupThreshold}`)
            }
        }

        numbers.push(count)
        console.log(numbers)
        return numbers
    }

    function createChar(canvas, type, numbers, dataLabel, lineColor, borderWith,) {
        const myChart = new Chart(canvas, {
        type: type,
        data: {
            labels: dataLabel,
            datasets: [{
                label: '',
                data: [...numbers],
                backgroundColor: [
                    'rgba(255, 99, 132, 1)',

                ],
                borderColor: [
                    lineColor,
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                ],
                borderWidth: borderWith,
            },]
        },
        options: {

            
            plugins: {
                legend: {
                    display: false
                }
            },
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true
                }
            }    
        }
    });

    return myChart
    }


    </script>

    <script>
        console.log(lineGraph.config.type, '!!!')
        let currentGraph = lineGraph;
        const colors = {
            'red': 164,
            'blue': 7,
            'green': 7
        }

        

        document.getElementById('myChart').addEventListener('click', () => {
            currentGraph = lineGraph;
            resetColors()
        })

        document.getElementById('barGraph').addEventListener('click', () => {
            currentGraph = barGraph;
            resetColors()
        })

       

        const redInput = document.getElementById('red');
        const blueInput = document.getElementById('blue');
        const greenInput = document.getElementById('green');

        function resetColors() {
            colors['red'] = 164;
            colors['blue'] = 7;
            colors['green']= 7;
            console.log(redInput.value)
            redInput.value = 164;
            blueInput.value = 7;
            greenInput.value = 7;
        }

        function updateGraphColor(graph, input, color) {
            colors[color] = Number(redInput.value)
            if (graph.config.type == 'bar') {
                graph.data.datasets[0].backgroundColor.shift()
                graph.data.datasets[0].backgroundColor.push(`rgba(${colors.red}, ${colors.green}, ${colors.blue}, 0.84)`)
            } else if (graph.config.type == 'line'){
                graph.data.datasets[0].borderColor.shift()
                graph.data.datasets[0].borderColor.unshift(`rgba(${colors.red}, ${colors.green}, ${colors.blue}, 0.84)`)
            }
            graph.update()
        }

        $("#red").on("input change", function() {
            updateGraphColor(currentGraph, redInput, 'red')
        });

        $("#green").on("input change", function() {
            updateGraphColor(currentGraph, greenInput, 'green')


        });

        $("#blue").on("input change", function() {
            updateGraphColor(currentGraph, blueInput, 'blue')
        });

        console.log(lineGraph.data.datasets[0].borderColor, 'data')
        console.log(myChart)
    </script>
    
</body>
</html>